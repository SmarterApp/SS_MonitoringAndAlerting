/*******************************************************************************
 * Educational Online Test Delivery System
 * Copyright (c) 2013 American Institutes for Research
 * 
 * Distributed under the AIR Open Source License, Version 1.0
 * See accompanying file AIR-License-1_0.txt or at
 * http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 ******************************************************************************/
package org.opentestsystem.shared.monitoringalerting.service.impl;

import org.opentestsystem.shared.monitoringalerting.persistence.AlertRepository;
import org.opentestsystem.shared.monitoringalerting.persistence.LogRepository;
import org.opentestsystem.shared.monitoringalerting.persistence.MetricInfoRepository;
import org.opentestsystem.shared.monitoringalerting.persistence.NotificationRepository;
import org.opentestsystem.shared.monitoringalerting.service.LogCleanupService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;

public class LogCleanupServiceImpl implements LogCleanupService {

	private static final Logger LOGGER = LoggerFactory.getLogger(LogCleanupServiceImpl.class);

    @Autowired
    private LogRepository logRepository;
    
    @Autowired
    private MetricInfoRepository metricRepository;
    
    @Autowired
    private AlertRepository alertRepository;
    
    @Autowired
    private NotificationRepository notificationRepository;
	
	@Value("${mna.clean.days:30}")
	private Integer maxAgeInDays;
	
	@Override
	public void cleanupLogs() {
		logRepository.removeByAgeGreatherThanDays(maxAgeInDays);
		metricRepository.removeByAgeGreatherThanDays(maxAgeInDays);
		alertRepository.removeByAgeGreatherThanDays(maxAgeInDays);
		notificationRepository.removeByAgeGreatherThanDays(maxAgeInDays);
	}

}
